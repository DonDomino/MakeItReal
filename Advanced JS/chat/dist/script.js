document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector("#save-user"),t=document.querySelector("#user-name");e.addEventListener("click",()=>{localStorage.setItem("userName",t.value),console.log(localStorage.userName),document.getElementById("login").style.display="none",a.collection("usuarios").onSnapshot(e=>{e.docChanges.forEach(e=>{if("added"===e.type){let t=e.doc.data();d(t)}})}),function(){let e=t.value;a.collection("usuarios").where("name","==",e).get().then(e=>e.empty).then(e=>{e&&function(){let e=document.querySelector("#chatInput"),t={name:localStorage.userName};l(t),e.value=" "}()})}()});firebase.initializeApp({apiKey:"AIzaSyCy4XdpVWTx6-gwMALsoNTgG9QA1ntki2E",authDomain:"chat-58c65.firebaseapp.com",databaseURL:"https://chat-58c65.firebaseio.com",projectId:"chat-58c65",storageBucket:"chat-58c65.appspot.com",messagingSenderId:"574191972101",appId:"1:574191972101:web:1dcf3fd7bcae2ddb"});let a=firebase.firestore();const n=()=>{a.collection("chats").orderBy("date","asc").onSnapshot(e=>{e.docChanges.forEach(e=>{if("added"===e.type){(e=>{let t=document.createElement("div");t.classList.add("chats"),t.innerHTML=`<h3>${e.name}</h3><span>${e.date}</span><p>${e.body}</p>`,document.querySelector(".window").appendChild(t)})(e.doc.data())}})})},o=()=>{let e=document.querySelector("#chatInput");(e=>{a.collection("chats").add({name:e.name,date:e.date,body:e.body})})({name:localStorage.userName,date:(()=>{let e=new Date,t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()],a=e.getDate(),n=e.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0});return t.concat(" ",a," ",n)})(),body:e.value}),e.value=" "},c=()=>{document.querySelector("#chatInput").addEventListener("keydown",e=>{"Enter"===e.key&&(o(),document.querySelector(".window").scrollBy(0,100))})},d=e=>{let t=document.createElement("li");t.innerHTML=`<div id="${e.name}" class="users">\n          <i class="fas fa-circle"></i>\n          <span>${e.name}</span>\n          <i class="fas fa-ellipsis-v"></i>\n        </div>`,document.querySelector("ul").appendChild(t)};const l=e=>{a.collection("usuarios").add({name:e.name})};(()=>{document.querySelector("#user4").addEventListener("click",()=>{(()=>{let e=document.querySelector(".window");if(e.childElementCount>0)for(;e.firstChild;)e.firstChild.remove()})(),n()})})(),c()});